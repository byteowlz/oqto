# Oqto Configuration
# Generated by Ansible

"$schema" = "https://raw.githubusercontent.com/byteowlz/schemas/refs/heads/main/oqto/oqto.backend.config.schema.json"

profile = "default"

[logging]
level = "info"

[runtime]
timeout = 60
fail_fast = true

[backend]
mode = "{{ oqto_backend }}"

{% if oqto_backend == "container" %}
[container]
runtime = "docker"
default_image = "oqto-dev:latest"
base_port = 41820
{% endif %}

{% if oqto_backend == "local" %}
[local]
enabled = true
opencode_binary = "opencode"
fileserver_binary = "fileserver"
ttyd_binary = "ttyd"
workspace_dir = "/var/lib/oqto/workspaces/{% raw %}{user_id}{% endraw %}"
single_user = {{ 'true' if oqto_mode == 'single' else 'false' }}

{% if oqto_mode == "multi" %}
[local.linux_users]
enabled = true
prefix = "octo_"
uid_start = 2000
group = "{{ oqto_group }}"
shell = "/bin/bash"
use_sudo = true
create_home = true
{% endif %}
{% endif %}

[auth]
dev_mode = false
# jwt_secret = "CHANGE_ME_GENERATE_WITH_openssl_rand_base64_48"

[sessions]
auto_attach = "off"
auto_attach_scan = true

[pi]
enabled = true
executable = "pi"
default_provider = "anthropic"
default_model = "claude-sonnet-4-20250514"
{% if oqto_backend == "local" %}
runtime_mode = "{% if oqto_mode == 'multi' %}runner{% else %}local{% endif %}"
{% else %}
runtime_mode = "container"
{% endif %}

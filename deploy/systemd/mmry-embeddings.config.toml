# mmry Central Embeddings Service Configuration
# Place at /etc/mmry/config.toml
#
# This service provides embeddings and reranking for all octo sessions.
# Per-user mmry instances delegate heavy operations here.

[service]
enabled = true
auto_start = false
idle_timeout_seconds = 0  # Never unload models

[external_api]
enable = true
host = "0.0.0.0"
port = 8081
require_api_key = true
api_key = "${MMRY_API_KEY}"  # Set via environment
max_input_chars = 32000
max_batch_size = 128
request_timeout_seconds = 60
console_enable = true
console_redact_secrets = true

[embeddings]
enabled = true
# nomic-embed-text-v1.5 is a good balance of quality and speed
model = "nomic-ai/nomic-embed-text-v1.5"
dimension = 768
batch_size = 64
backend = "fastembed"

[search]
rerank_enabled = true
rerank_model = "BAAI/bge-reranker-base"
default_limit = 20

[sparse_embeddings]
# Sparse embeddings are optional, disable for the hub
enabled = false

[hmlr]
# HMLR is handled by per-user instances, not the hub
enabled = false

[analyzer]
# Analyzer is handled by per-user instances
enabled = false

[guardrails]
enabled = false

[stores]
directory = "/var/lib/mmry/stores"
default = "hub"
